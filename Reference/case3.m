function mpc = case3
%% IEEE 3节点算例，附带计算过程 Author：Kang-S
% https://wenku.baidu.com/view/8a55215432687e21af45b307e87101f69e31fb7f.html
% ------------------------------------------------------------------导纳矩阵
%   6.2500 -18.7500i  -1.2500 + 3.7500i  -5.0000 +15.0000i
%  -1.2500 + 3.7500i   2.9167 - 8.7500i  -1.6667 + 5.0000i
%  -5.0000 +15.0000i  -1.6667 + 5.0000i   6.6667 -20.0000i
% ------------------------------------------------------------------迭代公式
% ┌ -0.32575 ┐    ┌ 9.205632   -5.15    -1.71667 ┐ ┌   Δδ1   ┐
% |   -0.3   | =  |  -5.15      20.9     6.36667 | |   Δδ3   |
% └   0.65   ┘    └ 1.71667   -6.96667    19.1   ┘ └  ΔU3/U3 ┘
% 其中雅可比矩阵用matpower是：
%    8.7500   -5.0000   -1.6667
%   -5.0000   20.0000    6.6667
%    1.6667   -6.6667   20.0000
% ------------------------------------------------------------------电压更新
% Δδ1     -0.049875      δ1    -0.049875 （-2.8580°）
% Δδ3     -0.034539      δ3    -0.034539 （-1.980° ）
% ΔU3/U3   0.025916      U3     1.025916  p.u
% ------------------------------------------------------------------检查收敛
% P2   -0.30009     ΔP2    0.00009
% P3   -0.060407    ΔP3    0.00407
% Q3   -0.2224      ΔQ3   -0.276
% ----------------open--------------------------------------------------继续迭代
% 迭代次数      节点1      节点2             节点3
%    0        1.05（0）   1.03（0）         1.00（0）
%    1        1.05（0）   1.035（-2.858°）  1.025917（-1.979°）
%    2        1.05（0）   1.035（-2.8517°） 1.02476（-1.947°）
% ------------------------------------------------------------------平衡节点
% S1 = 0.91366 + j0.2405
% ------------------------------------------------------------------支路潮流
% S12 =  0.2297  + j0.0165     S21 = -0.2233  - j0.00493
% S13 =  0.68396 + j0.224      S31 = -0.6746  - j0.19585
% S23 = -0.07413 + j0.0554     S32 =  0.07461 - j0.054

%% MATPOWER Case Format : Version 2
mpc.version = '2';

%%-----  Power Flow Data  -----%%
%% system MVA base
mpc.baseMVA = 100;

%% bus data
%	bus_i	type	Pd	Qd      Gs	Bs	area	Vm      Va	baseKV	zone	Vmax	Vmin
mpc.bus = [
	1       3       0	0       0	0	1       1.05	0	230     1       1.1     0.9;
	2       2       50	20      0	0	1       1.03    0	230     1       1.1     0.9;
	3       1       60	25      0	0	1       1       0	230     1       1.1     0.9;
];

%% generator data
%	bus	Pg      Qg	Qmax	Qmin	Vg	mBase	status	Pmax	Pmin	Pc1	Pc2	Qc1min	Qc1max	Qc2min	Qc2max	ramp_agc	ramp_10	ramp_30	ramp_q	apf
mpc.gen = [
	1	0       0	30	-30	1	100	1	40	0	0	0	0	0	0	0	0	0	0	0	0;
	2	20      0	127.5	-127.5	1	100	1	170	0	0	0	0	0	0	0	0	0	0	0	0;
	3	0   	0	390	-390	1	100	1	520	0	0	0	0	0	0	0	0	0	0	0	0;
];

%% branch data
%	fbus	tbus	r	x	b	rateA	rateB	rateC	ratio	angle	status	angmin	angmax
mpc.branch = [
	1	2	0.08	0.24	0	400	400	400	0	0	1	-360	360;
	1	3	0.02	0.06	0	0	0	0	0	0	1	-360	360;
	2	3	0.06	0.18	0	0	0	0	0	0	1	-360	360;
];

%%-----  OPF Data  -----%%
%% generator cost data
%	1	startup	shutdown	n	x1	y1	...	xn	yn
%	2	startup	shutdown	n	c(n-1)	...	c0
mpc.gencost = [
	2	0	0	2	14	0;
	2	0	0	2	15	0;
	2	0	0	2	30	0;
	2	0	0	2	40	0;
	2	0	0	2	10	0;
];
